<ng2-slim-loading-bar class="navbar-fixed-top" [color]="'#128950'" [height]="'3px'"></ng2-slim-loading-bar>
<quietthyme-header></quietthyme-header>
<div class="main-container">
    <section class="space--sm switchable switchable--switch  ">
        <div class="container">
            <div class="row">
                <div class="col-sm-12">
                    <div class="height-50 imagebg border--round" data-overlay="2">
                        <div class="background-image-holder library-bg">
                        </div>
                        <div class="pos-vertical-center col-sm-6 boxed boxed--lg bg--none">
                            <h2>Library</h2>
                            <p class="lead">
                                Your library is accessible anytime, anywhere, on any device

                                It doesn't matter if your have 10 books or 1000's of books. Quietthyme can help you easily manage a library of any size.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
            <!--end of row-->
        </div>
        <!--end of container-->
    </section>


    <quietthyme-opds-panel></quietthyme-opds-panel>

    <section class=" ">
        <div class="container">
            <div class="row">
                <div class="col-sm-4">
                    <div class="masonry-filter-container">
                        <span>Storage:</span>
                        <div class="masonry-filter-holder">
                            <div class="masonry__filters" data-filter-all-text="Storage">
                                <ul>
                                    <li [ngClass]="{'active': !filter.storage_id}" (click)="setStorage(null)">All Storage</li>

                                    <li *ngFor="let serviceStatus of connected" [ngClass]="{'active': filter.storage_id == serviceStatus.storage_id}" (click)="setStorage(serviceStatus)">{{ storageDetails[serviceStatus.storage_type].display_name }}</li>

                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-sm-4">
                    <div class="masonry-filter-container">
                        <span>Sort By:</span>
                        <div class="masonry-filter-holder">
                            <div class="masonry__filters" data-filter-all-text="Storage">
                                <ul>
                                    <li [ngClass]="{'active': !filter.sort}" (click)="setSort(null)">Title</li>
                                    <li [ngClass]="{'active': filter.sort == 'primary_author'}" (click)="setSort('primary_author')">Author</li>
                                    <li [ngClass]="{'active': filter.sort == 'updated_at'}" (click)="setSort('updated_at')">Added Date</li>

                                </ul>
                            </div>
                        </div>
                    </div>

                </div>
                <div class="col-sm-4">
                    <button type="button" class="btn btn--primary pull-right" (click)="openModalBookUpload()">Add Books</button>
                </div>

            </div>
            <div
                    infiniteScroll
                    [infiniteScrollDistance]="2"
                    [infiniteScrollThrottle]="500"
                    [infiniteScrollDisabled]="bookListAll"
                    (scrolled)="onScroll()"
                    class="row library-books">


                <masonry [useImagesLoaded]="true">


                    <masonry-brick *ngFor="let book of bookList; let myIndex = index" class="col-sm-3 masonry__item">
                        <div class="card card-2 text-center">
                            <div class="card__top">
                                <span class="label" *ngIf="book.series_name">{{ book.series_name }}</span>

                                <a routerLink="/book/{{ book.id }}" class="library-book-cover-wrapper">
                                    <img *ngIf="book.cover" class="library-book-cover" src="https://s3.amazonaws.com/{{ book.cover }}" alt="{{ book.title }}">
                                    <img *ngIf="!book.cover" class="library-book-cover" src="assets/images/noart.png" alt="{{ book.title }}">
                                </a>
                            </div>
                            <div class="card__body">
                                <h4>{{ book.title }}</h4>
                                <span class="type--fade">{{ book.authors}}</span>

                            </div>
                            <div class="card__bottom text-center">
                                <div class="card__action">
                                    <span class="h6 type--uppercase">Info</span>
                                    <a routerLink="/book/{{ book.id }}">
                                        <i class="glyphicon glyphicon-info-sign"></i>
                                    </a>
                                </div>
                                <div class="card__action">
                                    <span class="h6 type--uppercase">Download</span>
                                    <a (click)="downloadBook(book)" [ngClass]="{'downloading': loading.download[book.id]}">
                                        <i class="glyphicon glyphicon-download"></i>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </masonry-brick>

                </masonry><!-- #shop end -->

            </div>
            <!--end of row-->
        </div>
        <!--end of container-->
    </section>

    <section *ngIf="bookList.length == 0 && !loading.list" class="text-center">
        <div class="container">
            <div class="row">
                <div class="col-sm-10 col-md-8" style="padding-bottom:50px;">
                    <h1>Your {{ displayNameForStorageId(filter.storage_id) }} Library is empty :(</h1>
                    <p class="lead">
                        It doesn't look like you've added any books to your {{ displayNameForStorageId(filter.storage_id) }} library yet.
                        <br/>Don't worry, there's a couple of ways to do so.
                    </p>
                </div>
            </div>
            <div class="row">
                <div class="col-sm-4">
                    <div class="feature feature-2 boxed boxed--border">
                        <i class="icon icon-Clock-Back color--primary"></i>
                        <div class="feature__body">
                            <p>
                                On the go? Just drag some books into your <a href="https://quietthyme.uservoice.com/knowledgebase/articles/123761#blackhole" target="_blank">Cloud Storage blackhole folder</a>, and we'll add them to your library automatically
                            </p>
                        </div>
                    </div>
                    <!--end feature-->
                </div>
                <div class="col-sm-4">
                    <div class="feature feature-2 boxed boxed--border">
                        <i class="icon icon-Life-Jacket color--primary"></i>
                        <div class="feature__body">
                            <p>
                                Add books using the <a class="link" (click)="openModalBookUpload()">Web Uploader</a>. Simple, easy to use. What more do you want?
                            </p>
                        </div>
                    </div>
                    <!--end feature-->
                </div>
                <div class="col-sm-4">
                    <div class="feature feature-2 boxed boxed--border">
                        <i class="icon icon-Duplicate-Window color--primary"></i>
                        <div class="feature__body">
                            <p>
                                Manage your library using Calibre? No problem, we have a <a href="https://quietthyme.uservoice.com/knowledgebase/articles/123761#calibre" target="_blank">powerful plugin</a> waiting for you.
                            </p>
                        </div>
                    </div>
                    <!--end feature-->
                </div>

            </div>
            <!--end of row-->
        </div>
        <!--end of container-->
    </section>
    <section *ngIf="bookList.length == 0 && loading.list" class="text-center">
        <div class="container">
            <div class="row">
                <div class="col-sm-10 col-md-8" style="padding-bottom:50px;">
                    <h1>Loading your {{ displayNameForStorageId(filter.storage_id) }} Library. Please wait.</h1>
                    <p class="lead">
                        We're loading your {{ displayNameForStorageId(filter.storage_id) }} library right now, it may take a few moments.
                    </p>
                </div>
            </div>
        </div>
        <!--end of container-->
    </section>


    <quietthyme-footer></quietthyme-footer>
</div>
