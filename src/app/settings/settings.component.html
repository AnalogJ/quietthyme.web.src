<ng2-slim-loading-bar class="navbar-fixed-top" [color]="'#128950'" [height]="'3px'"></ng2-slim-loading-bar>

<quietthyme-header></quietthyme-header>

<div class="main-container">
    <section class="bg--secondary space--sm">
        <div class="container">
            <div class="row">
                <div class="col-md-4">
                    <div class="boxed boxed--lg boxed--border">
                        <div class="text-block text-center">
                            <img alt="avatar" [src]="gravatarUrl(userData.email)" class="image--sm" />
                            <span class="h5 capitalize">{{ userData.name }}</span>
                            <span class="capitalize">{{ userData.plan }} Account</span>
                            <span class="label">{{ userData.plan }}</span>
                        </div>
                        <hr>
                        <div class="text-block">
                            <ul class="menu-vertical">
                                <li>
                                    <a (click)="selectedTab='profile'" >Profile</a>
                                </li>
                                <li>
                                    <a (click)="selectedTab='notifications'">Notifications</a>
                                </li>
                                <li>
                                    <a (click)="selectedTab='billing'">Catalog Details</a>
                                </li>
                                <li>
                                    <a (click)="selectedTab='password'">Password</a>
                                </li>
                                <li>
                                    <a (click)="selectedTab='delete'">Delete Account</a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="col-md-8">
                    <div class="boxed boxed--lg boxed--border">
                        <div *ngIf="selectedTab == 'profile'" id="account-profile" class="account-tab">
                            <h4>Profile</h4>
                            <form>
                                <div class="row">
                                    <div class="col-sm-12">
                                        <label>Name:</label>
                                        <input type="text" name="name" [(ngModel)]="updateData.name" />
                                    </div>

                                    <div class="col-sm-12">
                                        <label>Email Address:</label>
                                        <div class="uneditable-input disabled">{{ userData.email }}</div>
                                    </div>

                                    <div class="col-md-3 col-sm-4">
                                        <button (click)="saveProfile()" [disabled]="loading.updateUser" class="btn btn--primary type--uppercase">Save Profile</button>
                                    </div>
                                    <!-- div class="col-md-2">
                                        <span class="label animate-flicker">Saved!</span>
                                    </div -->
                                </div>
                            </form>
                        </div>
                        <div *ngIf="selectedTab == 'notifications'" id="account-notifications" class="account-tab">
                            <h4>Blackhole Notifications</h4>
                            <p>Would you like to recieve notifications when books are processed via the blackhole folders:</p>

                            <form>
                                <button *ngIf="hasPushNotificationSubscription" (click)="unsubscribePushNotifications()" class="btn btn--error type--uppercase">Unsubscribe from Notifications</button>
                                <button *ngIf="hasPushNotificationSubscription" (click)="testPushNotifications()" class="btn btn--primary type--uppercase">Test Notification</button>

                                <button *ngIf="!hasPushNotificationSubscription" (click)="subscribePushNotifications()" class="btn btn--primary type--uppercase">Enable Notifications</button>
                            </form>

                        </div>
                        <div *ngIf="selectedTab == 'billing'" id="account-billing" class="account-tab">
                            <h4>Catalog Details</h4>
                            <form>
                                <div class="row">
                                    <div class="col-sm-12">
                                        <label>Catalog ID:</label>
                                        <div class="uneditable-input disabled">{{ userData.catalog_token }}</div>
                                    </div>

                                    <div class="col-md-3 col-sm-4">
                                        <button (click)="regenCatalog()" [disabled]="loading.regenerateCatalog" class="btn btn--primary type--uppercase">Regenerate Catalog</button>
                                    </div>
                                </div>
                            </form>
                        </div>
                        <div *ngIf="selectedTab == 'password'" id="account-password" class="account-tab">
                            <h4>Password</h4>
                            <p>Passwords must be at least 6 characters in length.</p>
                            <form>
                                <div class="row">
                                    <div class="col-xs-12">
                                        <label>Old Password:</label>
                                        <input [(ngModel)]="oldPassword" type="password" name="old-password" />
                                    </div>
                                    <div class="col-sm-6">
                                        <label>New Password:</label>
                                        <input [(ngModel)]="newPassword" type="password" name="new-password" />
                                    </div>
                                    <div class="col-sm-6">
                                        <label>Retype New Password:</label>
                                        <input [(ngModel)]="confirmPassword" type="password" name="new-password-confirm" />
                                    </div>
                                    <div class="col-md-4 col-sm-5">
                                        <button (click)="userPasswordReset()" [disabled]="loading.passwordReset" class="btn btn--primary type--uppercase">Save Password</button>
                                    </div>
                                </div>
                            </form>
                        </div>
                        <div *ngIf="selectedTab == 'delete'" id="account-delete" class="account-tab">
                            <h4>Delete Account</h4>
                            <p>Permanently remove your account using the button below. Warning, this action is permanent.</p>
                            <form>
                                <button (click)="showContactForm()" class="btn btn--error type--uppercase">Delete Account</button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
            <!--end of row-->
        </div>
        <!--end of container-->
    </section>
    <quietthyme-footer></quietthyme-footer>

</div>
